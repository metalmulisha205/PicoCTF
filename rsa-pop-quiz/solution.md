# PicoCTF RSA-Pop-Quiz Challenge Writeup
## Introduction
This challenge provides a command to netcat onto a network, which then provides a series of rsa challenges to solve and enter into the command prompt to recieve the flag. To solve the solutions in this challenge I created a python script that is provided in the same directiory as this writeup. 
## RSA Background
The following website provided vital information on rsa formulas used to solve the problems to this rsa quiz. All formulas used for this challenge are listed on the website: 
* https://www.tutorialspoint.com/cryptography_with_python/cryptography_with_python_understanding_rsa_algorithm.htm

## Connecting to the Network
The following command is provided to connect to the machine: 
* nc jupiter.challenges.picoctf.org 1981 <br>

## <u>Problem #1</u>
This problem provides the numbers p = 60413 and q = 76753 and asks for n. Using the formula n = p*q, the solution is n = 4636878989. 

## <u>Problem #2</u>
The next problem provides p = 54269 and n = 5051846941 and asks to find q. Manipulating the formula used in the previous challenge q can be solved using q = n/p, leading to the solution q = 93089. 

## <u>Problem #3</u>
Problem 3 provides e and n and asks if it is possible and feasible to solve for p and q. While it is theoretically possible, the idea of rsa is to use massive, prime numbers for p and q to make it nearly impossible to break the algorithm in a reasonable amount of time. Answering N for no solves this problem

## <u>Problem #4</u>
The inputs for this problem are p = 66347 and q = 12611. This problem asks for the totient(n) as the output. The following formula can be used to solve this problem. totient(n) = (p-1) * (q-1). Plugging in p and q the solution is totient(n) = 836623060

## <u>Problem #5</u>
This problem provides the following inputs and asks for the ciphertext:
* plaintext:    
  * 6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717
* e: 
  * 3
* n:
  * 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331

The following formula is used to encrypt plaintext in rsa: <b>ciphertext = $p^e$ % $n$ </b> <br>
Plugging in the numbers above the solution is: 
* ciphertext:        
  * 256931246631782714357241556582441991993437399854161372646318659020994329843524306570818293602492485385337029697819837182169818816821461486018802894936801257629375428544752970630870631166355711254848465862207765051226282541748174535990314552471546936536330397892907207943448897073772015986097770443616540466471245438117157152783246654401668267323136450122287983612851171545784168132230208726238881861407976917850248110805724300421712827401063963117423718797887144760360749619552577176382615108244813

## <u>Problem #6</u>
This problem provides the ciphertext, e and n and asks if it is possible and feasible to produce the plaintext. Again, the size and choice of prime numbers for p and q in rsa makes it very difficult to decrypt the ciphertext without a private key, which is not provided. Therefore, the answer is n for no.

## <u>Problem #7</u>
This problem provides the following inputs and asks for d as the output: 
* p: 
  * 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637

* q:
  * 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559

* e: 
  * 65537

Manipulating the fomula $ed$ = 1 % $(p-1)(q-1)$ yields the fomula $d$ = $e^-1$ % $(p-1)(q-1)$ <br>
Plugging in p, q and e yields the result:
* d:
  * 1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729

## <u>Problem #8</u>
The final problem provides p, e, n and ciphertext and requests the plaintext:
* e:
  * 65537
* p:
  *  153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433

* n: 
  * 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239

* ciphertext:
  * 18031488536864379496089550017272599246134435121343229164236671388038630752847645738968455413067773166115234039247540029174331743781203512108626594601293283737392240326020888417252388602914051828980913478927759934805755030493894728974208520271926698905550119698686762813722190657005740866343113838228101687566611695952746931293926696289378849403873881699852860519784750763227733530168282209363348322874740823803639617797763626570478847423136936562441423318948695084910283653593619962163665200322516949205854709192890808315604698217238383629613355109164122397545332736734824591444665706810731112586202816816647839648399

This problem is solved by calculating q using the formula $q = n/p$, then calculating d using the formula from problem #7: $d$ = $e^-1$ % $(p-1)(q-1)$. Finally, the ciphertext can be deciphered using the formula $Cd$ % $n$ where $C$ is the ciphertext. The final result is the plaintext: 
* 14311663942709674867122208214901970650496788151239520971623411712977120586163535880168563325


## Final Solution ##
After entering the solution to all of the problems the program informs us that converting the plaintext from problem #8 to a hex number and finally to ascii will yield the flag. The following website can be used to convert the plaintext to a hex number: https://www.rapidtables.com/convert/number/decimal-to-hex.html. Afterwards, using the same website to convert the hex number to ascii yields the flag: <b>picoCTF{wA8_th4t$_ill3aGal..ode01e4bb}</b>




